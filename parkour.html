<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Parkour nas Nuvens</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    /* Estilo geral futurista simples */
    body {
      margin: 0;
      background: radial-gradient(circle at center, #0a0f3d 0%, #020519 90%);
      font-family: 'Courier New', Courier, monospace;
      color: #0ff;
      user-select: none;
      overflow: hidden;
      display: flex;
      height: 100vh;
      align-items: stretch;
    }

    /* Barra lateral fixa */
    #sidebar {
      width: 160px;
      background: #011230;
      box-shadow: 0 0 40px #0ff inset;
      padding: 24px 20px;
      display: flex;
      flex-direction: column;
      justify-content: flex-start;
      gap: 24px;
      box-sizing: border-box;
      border-radius: 0 20px 20px 0;
    }

    #sidebar h2 {
      margin: 0 0 12px 0;
      font-weight: 700;
      text-shadow: 0 0 10px #0ff;
      letter-spacing: 1.2px;
      font-size: 20px;
      user-select: none;
    }

    #scoreDisplay, #recordDisplay {
      font-size: 28px;
      font-weight: 700;
      text-align: center;
      text-shadow: 0 0 15px #0ff;
      user-select: none;
    }

    #resetBtn {
      padding: 12px;
      border: none;
      background: #0ff;
      border-radius: 14px;
      font-size: 18px;
      font-weight: 700;
      color: #020519;
      cursor: pointer;
      box-shadow: 0 0 18px #0ff;
      transition: background 0.3s ease;
      user-select: none;
    }

    #resetBtn:hover {
      background: #4efcff;
    }

    /* Conteúdo principal - jogo */
    #gameContainer {
      flex-grow: 1;
      display: flex;
      justify-content: center;
      align-items: center;
      position: relative;
    }

    canvas {
      background: transparent;
      border-radius: 20px;
      box-shadow: 0 0 25px #0ff;
      display: block;
    }

    /* HUD removido do canvas, pois a barra lateral exibe pontuação */

    #gameOver {
      position: absolute;
      inset: 0;
      display: none;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      background: rgba(0, 0, 0, 0.85);
      font-size: 36px;
      font-weight: 700;
      color: #0ff;
      text-shadow: 0 0 18px #0ff, 0 0 30px #0ff;
      letter-spacing: 1.5px;
      user-select: none;
      border-radius: 20px;
      z-index: 10;
      padding: 20px;
      text-align: center;
    }

    #gameOver button {
      margin-top: 20px;
      padding: 12px 24px;
      border: none;
      background: #0ff;
      border-radius: 14px;
      font-size: 20px;
      font-weight: 700;
      color: #020519;
      cursor: pointer;
      box-shadow: 0 0 18px #0ff;
      transition: background 0.3s ease;
      user-select: none;
    }

    #gameOver button:hover {
      background: #4efcff;
    }

    /* Tela inicial */
    #startScreen {
      position: absolute;
      inset: 0;
      background: rgba(0, 0, 0, 0.9);
      display: flex;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      gap: 30px;
      border-radius: 20px;
      color: #0ff;
      font-size: 36px;
      font-weight: 700;
      text-shadow: 0 0 18px #0ff, 0 0 30px #0ff;
      letter-spacing: 1.5px;
      user-select: none;
      z-index: 20;
    }

    #startScreen button {
      padding: 16px 32px;
      border: none;
      background: #0ff;
      border-radius: 16px;
      font-size: 24px;
      font-weight: 700;
      color: #020519;
      cursor: pointer;
      box-shadow: 0 0 25px #0ff;
      transition: background 0.3s ease;
      user-select: none;
    }

    #startScreen button:hover {
      background: #4efcff;
    }
  </style>
</head>
<body>
  <div id="sidebar">
    <h2>Pontuação</h2>
    <div id="scoreDisplay">0</div>

    <h2>Recorde</h2>
    <div id="recordDisplay">0</div>

    <button id="resetBtn">Reiniciar</button>
  </div>

  <div id="gameContainer">
    <canvas id="game" width="400" height="600"></canvas>

    <div id="gameOver">
      <div id="finalScore">Game Over!</div>
      <button onclick="reset()">Reiniciar</button>
    </div>

    <div id="startScreen">
      <div>Parkour nas Nuvens</div>
      <button id="startBtn">Start Game</button>
    </div>
  </div>

  <script>
    const canvas = document.getElementById("game");
    const ctx = canvas.getContext("2d");
    const scoreDisplay = document.getElementById("scoreDisplay");
    const recordDisplay = document.getElementById("recordDisplay");
    const resetBtn = document.getElementById("resetBtn");
    const gameOverDiv = document.getElementById("gameOver");
    const finalScore = document.getElementById("finalScore");
    const startScreen = document.getElementById("startScreen");
    const startBtn = document.getElementById("startBtn");

    let player, platforms, score, running, cameraY, lavaY;
    let record = 0;
    let gameStarted = false;

    function reset() {
      const safeSpawnY = 400;
      const spawnPlatform = { x: 160, y: safeSpawnY, w: 80, h: 15 };
      platforms = [spawnPlatform];

      for (let i = 1; i < 8; i++) {
        const y = safeSpawnY - i * 100;
        const x = Math.random() * 320;
        const w = 60 + Math.random() * 20;
        platforms.push({ x, y, w, h: 15 });
      }

      const playerW = 40;
      const playerH = 40;

      player = {
        x: spawnPlatform.x + spawnPlatform.w / 2,
        y: spawnPlatform.y - playerH,
        w: playerW,
        h: playerH,
        vx: 0,
        vy: 0,
        jump: -12,
      };

      score = 0;
      cameraY = 0;
      lavaY = safeSpawnY + 250;
      running = true;
      gameOverDiv.style.display = "none";
      updateScoreDisplay();
      loop();
    }

    // Atualiza as pontuações na sidebar
    function updateScoreDisplay() {
      scoreDisplay.textContent = score;
      if(score > record) {
        record = score;
        localStorage.setItem('parkourRecord', record);
      }
      recordDisplay.textContent = record;
    }

    // Player futurista: esfera com brilho neon cyan e olhos simples
    function drawPlayer() {
      const px = player.x;
      const py = player.y + player.h / 2 - cameraY;

      // Corpo principal com gradiente neon cyan
      const grad = ctx.createRadialGradient(px, py, player.w / 4, px, py, player.w / 2);
      grad.addColorStop(0, "#0ff");
      grad.addColorStop(1, "rgba(0, 255, 255, 0.15)");

      ctx.fillStyle = grad;
      ctx.shadowColor = "#0ff";
      ctx.shadowBlur = 20;

      ctx.beginPath();
      ctx.ellipse(px, py, player.w / 2, player.h / 2, 0, 0, Math.PI * 2);
      ctx.fill();

      ctx.shadowBlur = 0;

      // Olhos minimalistas
      ctx.fillStyle = "#004d4d";
      ctx.beginPath();
      ctx.arc(px - 8, py - 5, 4, 0, Math.PI * 2);
      ctx.fill();
      ctx.beginPath();
      ctx.arc(px + 8, py - 5, 4, 0, Math.PI * 2);
      ctx.fill();
    }

    // Plataformas futuristas: retângulos com bordas arredondadas e brilho neon
    function drawPlatform(p) {
      const radius = 7;
      ctx.fillStyle = "#0ff";
      ctx.shadowColor = "#0ff";
      ctx.shadowBlur = 12;

      ctx.beginPath();
      ctx.moveTo(p.x + radius, p.y - cameraY);
      ctx.lineTo(p.x + p.w - radius, p.y - cameraY);
      ctx.quadraticCurveTo(p.x + p.w, p.y - cameraY, p.x + p.w, p.y + radius - cameraY);
      ctx.lineTo(p.x + p.w, p.y + p.h - radius - cameraY);
      ctx.quadraticCurveTo(p.x + p.w, p.y + p.h - cameraY, p.x + p.w - radius, p.y + p.h - cameraY);
      ctx.lineTo(p.x + radius, p.y + p.h - cameraY);
      ctx.quadraticCurveTo(p.x, p.y + p.h - cameraY, p.x, p.y + p.h - radius - cameraY);
      ctx.lineTo(p.x, p.y + radius - cameraY);
      ctx.quadraticCurveTo(p.x, p.y - cameraY, p.x + radius, p.y - cameraY);
      ctx.closePath();

      ctx.fill();
      ctx.shadowBlur = 0;
    }

    // Lava futurista: gradiente vermelho brilhante com brilho neon
    function drawLava() {
      const y = lavaY - cameraY;
      const lavaHeight = 600;

      const grad = ctx.createLinearGradient(0, y, 0, y + lavaHeight);
      grad.addColorStop(0, "#ff2200");
      grad.addColorStop(0.5, "#ff6600");
      grad.addColorStop(1, "#aa2200");

      ctx.fillStyle = grad;
      ctx.shadowColor = "#ff3300";
      ctx.shadowBlur = 25;
      ctx.fillRect(0, y, 400, lavaHeight);

      ctx.shadowBlur = 10;
      ctx.fillStyle = "#ffbb33";
      ctx.fillRect(0, y, 400, 10);

      ctx.shadowBlur = 0;
    }

    function update() {
      player.vy += 0.5;
      player.y += player.vy;
      player.x += player.vx;

      for (let p of platforms) {
        const onPlatform =
          player.vy > 0 &&
          player.x > p.x &&
          player.x < p.x + p.w &&
          player.y + player.h > p.y &&
          player.y + player.h < p.y + p.h;

        if (onPlatform) {
          player.vy = player.jump;
          score += 10;
          updateScoreDisplay();
        }
      }

      if (player.x < 0) player.x = 400;
      if (player.x > 400) player.x = 0;

      if (player.y - cameraY < 300) {
        cameraY = player.y - 300;
      }

      lavaY -= 3;

      if (player.y + player.h > lavaY) {
        running = false;
        finalScore.textContent = "Game Over! Score: " + score;
        gameOverDiv.style.display = "flex";
      }

      for (let i = 0; i < platforms.length; i++) {
        if (platforms[i].y - cameraY > 600) {
          const highest = platforms.reduce((a, b) => (a.y < b.y ? a : b));
          const newY = highest.y - (90 + Math.random() * 50);
          const newX = Math.min(340, Math.max(0, highest.x + (Math.random() * 160 - 80)));
          const newW = 50 + Math.random() * 30;
          platforms[i] = { x: newX, y: newY, w: newW, h: 15 };
        }
      }
    }

    function draw() {
      ctx.clearRect(0, 0, 400, 600);
      drawLava();
      drawPlayer();
      for (let p of platforms) drawPlatform(p);
    }

    function loop() {
      if (!running) return;
      update();
      draw();
      requestAnimationFrame(loop);
    }

    // Controles do jogo
    document.addEventListener("keydown", (e) => {
      if (!gameStarted) return;
      if (e.key === "ArrowLeft" || e.key === "a") player.vx = -4;
      if (e.key === "ArrowRight" || e.key === "d") player.vx = 4;
      if (e.key === "r" || e.key === "R") reset();
    });

    document.addEventListener("keyup", (e) => {
      if (!gameStarted) return;
      if (["ArrowLeft", "a", "ArrowRight", "d"].includes(e.key)) player.vx = 0;
    });

    // Reset via botão lateral
    resetBtn.addEventListener("click", () => {
      if (!gameStarted) return;
      reset();
    });

    // Start do jogo
    startBtn.addEventListener("click", () => {
      startScreen.style.display = "none";
      gameStarted = true;

      // Carrega recorde salvo localmente
      const savedRecord = localStorage.getItem('parkourRecord');
      if(savedRecord) record = parseInt(savedRecord);
      updateScoreDisplay();

      reset();
    });

  </script>
</body>
</html>
